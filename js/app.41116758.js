(function(t){function i(i){for(var a,r,l=i[0],o=i[1],h=i[2],c=0,d=[];c<l.length;c++)r=l[c],s[r]&&d.push(s[r][0]),s[r]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a]);u&&u(i);while(d.length)d.shift()();return n.push.apply(n,h||[]),e()}function e(){for(var t,i=0;i<n.length;i++){for(var e=n[i],a=!0,l=1;l<e.length;l++){var o=e[l];0!==s[o]&&(a=!1)}a&&(n.splice(i--,1),t=r(r.s=e[0]))}return t}var a={},s={app:0},n=[];function r(i){if(a[i])return a[i].exports;var e=a[i]={i:i,l:!1,exports:{}};return t[i].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=t,r.c=a,r.d=function(t,i,e){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,i){if(1&i&&(t=r(t)),8&i)return t;if(4&i&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var a in t)r.d(e,a,function(i){return t[i]}.bind(null,a));return e},r.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="/kalman/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],o=l.push.bind(l);l.push=i,l=l.slice();for(var h=0;h<l.length;h++)i(l[h]);var u=o;n.push([0,"chunk-vendors"]),e()})({0:function(t,i,e){t.exports=e("56d7")},"034f":function(t,i,e){"use strict";var a=e("64a9"),s=e.n(a);s.a},"0a03":function(t,i,e){},"56d7":function(t,i,e){"use strict";e.r(i);e("cadf"),e("551c"),e("097d");var a=e("2b0e"),s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"app"}},[e("Kalman")],1)},n=[],r=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("h2",{staticClass:"title"},[t._v("Kalman Filter 2D demo")]),e("h3",{staticClass:"subtitle"},[t._v("Antonio Vivace, June 2019")]),e("mu-row",{staticClass:"stats"},[e("mu-col",{staticStyle:{padding:"15px"},attrs:{span:"3"}},[e("div",{staticClass:"grid-cell"},[e("mu-button",{attrs:{color:t.startBtnColor},on:{click:t.handleStartButton}},[e("mu-icon",{attrs:{value:t.startBtnIcon}}),t._v(t._s(t.startBtnText))],1),t._v(" \n\t\t\t\t"),e("mu-button",{attrs:{color:"red"},on:{click:t.init}},[e("mu-icon",{attrs:{value:"undo"}}),t._v(" Reset")],1),e("br"),e("br"),t._v("\n\n\t\t\t\tMode:\n\t\t\t\t"),e("mu-select",{on:{change:t.init},model:{value:t.mode,callback:function(i){t.mode=i},expression:"mode"}},t._l(t.options,function(t,i){return e("mu-option",{key:t,attrs:{label:t,value:i}})}),1),e("br"),t._v("\n\t\t\t\tWidth: "+t._s(t.width)+"px\n\t\t\t\t"),e("mu-slider",{staticClass:"slider",attrs:{type:"range",min:0,max:1800,step:1,value:"75"},model:{value:t.width,callback:function(i){t.width=i},expression:"width"}}),t._v("\n\t\t\t\tHeight: "+t._s(t.height)+"px\n\t\t\t\t"),e("mu-slider",{staticClass:"slider",attrs:{type:"range",min:0,max:1e3,step:1,value:"75"},model:{value:t.height,callback:function(i){t.height=i},expression:"height"}}),t._v("\n\n\t\t\t\tNoise covariance: "+t._s(t.sigma)+"\n\t\t\t\t"),e("mu-slider",{staticClass:"demo-slider",attrs:{min:0,max:t.width/3,step:1},model:{value:t.sigma,callback:function(i){t.sigma=i},expression:"sigma"}}),e("mu-checkbox",{attrs:{label:"Trajectory"},model:{value:t.traj,callback:function(i){t.traj=i},expression:"traj"}}),e("mu-checkbox",{attrs:{label:"Real Input"},model:{value:t.drawReal,callback:function(i){t.drawReal=i},expression:"drawReal"}}),e("mu-checkbox",{attrs:{label:"Noisy"},model:{value:t.drawNoisy,callback:function(i){t.drawNoisy=i},expression:"drawNoisy"}}),e("mu-checkbox",{attrs:{label:"Noisy Traj"},model:{value:t.drawNoisyTraj,callback:function(i){t.drawNoisyTraj=i},expression:"drawNoisyTraj"}}),e("mu-checkbox",{attrs:{label:"Filtered"},model:{value:t.drawFiltered,callback:function(i){t.drawFiltered=i},expression:"drawFiltered"}}),e("mu-checkbox",{attrs:{label:"Filtered Traj"},model:{value:t.drawFilteredTraj,callback:function(i){t.drawFilteredTraj=i},expression:"drawFilteredTraj"}}),e("mu-checkbox",{attrs:{label:"Prediction"},model:{value:t.drawPrediction,callback:function(i){t.drawPrediction=i},expression:"drawPrediction"}}),e("h4",[t._v("Stats")]),t._v("\n\t\t\t\t"+t._s(t.status)),e("br"),e("code",[t._v(t._s(t.states.length))]),t._v(" states drawn."),e("br"),e("code",[t._v(t._s(Math.round(t.ms)))]),t._v(" ms per frame\n\t\t\t")],1)]),e("mu-col",{attrs:{span:"9"}},[e("div",{staticClass:"grid-cell"},[e("canvas",{ref:"ccont",staticClass:"kalmandemo",attrs:{width:t.width,height:t.height},on:{mouseleave:t.mouseLeave,pointermove:t.mouseOver}})])])],1),e("br"),e("br"),e("br"),e("br"),e("br"),e("span",{staticClass:"stats"}),t._m(0)],1)},l=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("small",{staticStyle:{"font-size":"1rem"}},[e("p",[e("b",[e("a",{staticStyle:{color:"#2c3e50"},attrs:{href:"https://github.com/avivace/kalman"}},[e("img",{staticStyle:{"vertical-align":"text-bottom"},attrs:{height:"24px",src:"https://akveo.github.io/eva-icons/outline/svg/github-outline.svg"}}),t._v(" Source Code")])])])])}],o=(e("6c7b"),e("6b54"),e("d225")),h=e("b0b4");(function(){function t(t,i){return isNaN(t)?i:t}Math.randomGaussian=function(i,e){if(i=t(i,0),e=t(e,1),void 0!==Math.randomGaussian.nextGaussian){var a=Math.randomGaussian.nextGaussian;return delete Math.randomGaussian.nextGaussian,a*e+i}var s,n,r,l;do{s=2*Math.random()-1,n=2*Math.random()-1,r=s*s+n*n}while(r>=1||0==r);return l=Math.sqrt(-2*Math.log(r)/r),Math.randomGaussian.nextGaussian=n*l,s*l*e+i},Math.getGaussianFunction=function(i,e,a){return i=t(i,0),e=t(e,1),a=t(a,1),function(t){return a*Math.pow(Math.E,-Math.pow(t-i,2)/(e*e*2))}}})();var u={data:function(){return{width:800,height:800,ctx:null,lastCalledTime:null,fps:0,framecount:0,status:"paused",states:[],framerate:160,lastPoint:null,A:null,B:null,H:null,Q:null,R:null,last:null,ms:0,mode:1,options:["Mouse","Square Path","1D"],realPoint:null,drawPhase:0,sigma:100,startBtnText:"Start",startBtnIcon:"play_arrow",startBtnColor:"blue",traj:!1,drawReal:!1,drawNoisy:!1,drawNoisyTraj:!1,drawFiltered:!1,drawFilteredTraj:!1,drawPrediction:!1}},mounted:function(){this.init(),this.frame()},methods:{handleStartButton:function(){"paused"==this.status?(this.status="running",this.startBtnText="Pause",this.startBtnIcon="pause"):(this.status="paused",this.startBtnText="Start",this.startBtnIcon="play_arrow")},getRandomInt:function(t){return Math.floor(Math.random()*Math.floor(t))},mouseLeave:function(){},mouseOver:function(t){var i=this.$refs.ccont,e=i.getBoundingClientRect();this.clientX=t.clientX-e.left,this.clientY=t.clientY-e.top},init:function(){this.drawPhase=0,this.states=[],this.realPoint=null;var t=window.$M,i=window.$V;this.A=t([[1,0,.2,0],[0,1,0,.2],[0,0,1,0],[0,0,0,1]]),this.H=t([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]),this.Q=t([[.01,0,0,0],[0,.01,0,0],[0,0,.01,0],[0,0,0,.01]]),this.R=t([[this.sigma,0,0,0],[0,this.sigma,0,0],[0,0,this.sigma,0],[0,0,0,this.sigma]]),this.lastPoint=i([0,0,0,0]),this.last=t([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);var e=this.$refs.ccont;this.ctx=e.getContext("2d",{alpha:!1}),this.ctx.fillStyle="#37474f",this.ctx.fillRect(0,0,this.width,this.height),this.State=function(){function t(i,e,a){Object(o["a"])(this,t),this.realInput=i,this.noisyInput=e,this.kalmanPoint=a,this.dead=!1}return Object(h["a"])(t,[{key:"get",value:function(){return[this.noisyInput.x,this.noisyInput.y,this.noisyInput.ttl]}},{key:"getK",value:function(){return[this.kalmanPoint.x,this.kalmanPoint.y]}},{key:"displayReal",value:function(){this.realInput.display("#0d47a1")}},{key:"displayFiltered",value:function(){this.kalmanPoint.display("#dd2c00")}},{key:"displayNoisy",value:function(){this.noisyInput.display("#388e3c")}},{key:"displayPrediction",value:function(){}},{key:"update",value:function(){this.realInput.update(),this.noisyInput.update(),this.kalmanPoint.update(),0==this.realInput.ttl&&(this.dead=!0)}}]),t}(),this.Point=function(){function t(i,e,a){Object(o["a"])(this,t),this.x=i,this.y=e,this.ttl=200,this.ctx=a}return Object(h["a"])(t,[{key:"display",value:function(t){var i=Math.round(255*this.ttl/200).toString(16);this.ctx.beginPath(),this.ctx.arc(this.x,this.y,2,0,2*Math.PI),this.ctx.fillStyle=t+i,this.ctx.fill()}},{key:"update",value:function(){this.ttl--}}]),t}()},frame:function(){var t=performance.now();if("running"==this.status){var i=window.$V,e=this.ctx;this.ctx.fillStyle="#1f1f31",this.ctx.fillRect(0,0,this.width,this.height);var a=4;if(0==this.mode?this.realPoint=new this.Point(this.clientX-3,this.clientY-3,e):1==this.mode?(null==this.realPoint&&(this.realPoint=new this.Point(180,180,e)),0==this.drawPhase?(this.realPoint=new this.Point(this.realPoint.x+a,this.realPoint.y,e),this.realPoint.x==this.width-180&&(this.drawPhase=1)):1==this.drawPhase?(this.realPoint=new this.Point(this.realPoint.x,this.realPoint.y+a,e),this.realPoint.y==this.height-180&&(this.drawPhase=2)):2==this.drawPhase?(this.realPoint=new this.Point(this.realPoint.x-a,this.realPoint.y,e),180==this.realPoint.x&&(this.drawPhase=3)):3==this.drawPhase&&(this.realPoint=new this.Point(this.realPoint.x,this.realPoint.y-a,e),180==this.realPoint.y&&(this.drawPhase=0))):2==this.mode&&(null==this.realPoint?(this.realPoint=new this.Point(0,this.height/2,e),this.drawPhase=0):(this.realPoint=new this.Point(this.realPoint.x+5,this.realPoint.y,e),this.realPoint.x==this.width&&(this.realPoint.x=0,this.states=[],this.lastPoint=i([this.realPoint.x,this.realPoint.y,0,0])))),2!=this.mode)var s=Math.round(this.realPoint.x+Math.randomGaussian(0,this.sigma));else s=this.realPoint.x;var n=Math.round(this.realPoint.y+Math.randomGaussian(0,this.sigma)),r=new this.Point(s,n,e),l=s-this.lastPoint.elements[0],o=n-this.lastPoint.elements[1],h=i([s,n,l,o]),u=this.A.multiply(this.lastPoint),c=this.A.multiply(this.last).multiply(this.A.transpose()).add(this.Q),d=this.H.multiply(c).multiply(this.H.transpose()).add(this.R),m=c.multiply(this.H.transpose()).multiply(d.inverse()),p=h.subtract(this.H.multiply(u));this.lastPoint=u.add(m.multiply(p)),this.last=window.Matrix.I(4).subtract(m.multiply(this.H)).multiply(c);var f=new this.Point(this.lastPoint.elements[0],this.lastPoint.elements[1],e);this.states.push(new this.State(this.realPoint,r,f));for(var v=this.states.length-1;v>0;--v){var y=this.states[v];if(this.drawReal&&y.displayReal(),this.drawFiltered&&y.displayFiltered(),this.drawNoisy&&y.displayNoisy(),y.update(),v>1){var w=y.get(),P=Math.round(255*w[2]/200).toString(16);if(this.drawNoisyTraj){var b=this.states[v-1].get();e.strokeStyle="#229922"+P,e.lineWidth=1,e.beginPath(),e.moveTo(w[0],w[1]),e.lineTo(b[0],b[1]),e.stroke()}if(this.drawFilteredTraj){w=y.getK(),b=this.states[v-1].getK();e.strokeStyle="#992200"+P,e.lineWidth=2,e.beginPath(),e.moveTo(w[0],w[1]),e.lineTo(b[0],b[1]),e.stroke()}}y.dead&&this.states.splice(v,1)}}this.lastCalledTime=performance.now();var x=performance.now()-t;this.ms=x,setTimeout(this.frame,1e3/this.framerate-x)}}},c=u,d=(e("6246"),e("2877")),m=Object(d["a"])(c,r,l,!1,null,"f975a2d8",null),p=m.exports,f={name:"app",components:{Kalman:p}},v=f,y=(e("034f"),Object(d["a"])(v,s,n,!1,null,null,null)),w=y.exports,P=e("30f4");e("d6f6"),e("d1e7");a["a"].use(P["a"]),a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(w)}}).$mount("#app")},6246:function(t,i,e){"use strict";var a=e("0a03"),s=e.n(a);s.a},"64a9":function(t,i,e){}});
//# sourceMappingURL=app.41116758.js.map